<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.farmingtool.mapper.DetailMachineMapper">

	<update id="updateDetailMachineStatus"  parameterType="String">
		UPDATE detailmachine
		SET machine_status = 1
		WHERE machine_no = #{machineNo}
	</update>
	
	<!-- 선택 날짜에 예약 가능한 기계 대수 카운트 : 예약 가능,불가능 판단 / 달력에 예약 가능 기계 대수 표시 -->
	<select id="countRentableMachine" parameterType="hashMap" resultType="String">
		SELECT machine_no 
		FROM detailmachine 
		WHERE machine_no NOT IN 
			(	
				SELECT machine_no 
				FROM rental_history 
				WHERE history_rentaldate = #{historyRentalDate}
			)	
				and fm_no = #{fmNo} and machine_status = 0
	</select>
	
	<select id="countDetailMachine" parameterType="String" resultType="int">
		SELECT count(machine_no)
		FROM detailmachine
		WHERE fm_no = #{fmNo};
	</select>
	
</mapper>
















